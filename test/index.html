<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Map - Display a map</title>
<style type="text/css">
    html,
    body {
        margin: 0px;
        height: 100%;
        width: 100%
    }

    .container {
        width: 100%;
        height: 100%
    }
</style>
<script type="text/javascript" src="./../dist/string-width.js"></script>

<body>


    <script>
        const { stringWidth, hasEmoji, hasArabic } = sw;
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const fontSize = 22;
        ctx.font = `${fontSize}px serif`;
        const tests = [
            'China to manage COVID-19 with measures \n against Class B infectious diseaseså·é’èŽ²å±…å£«',
            'helloå¤§å®¶å¥½jlfjalj23840284xxxxx',
            'abc-xxxä¸­å›½c,,,ssjl',
            'jfaljxx,xxx  åš“æ“¦ç¤¤åš“æ“¦ç¤¤  ã©ã†ã»ã†ã’ã‚“',
            'æŽç™½ï¼ˆ701å¹´2æœˆ28æ—¥â€”762å¹´12æœˆï¼‰ï¼Œ [38]  å­—å¤ªç™½ï¼Œå·é’èŽ²å±…å£«',
            'ãªã„ã‚Šãã»ã£ã‹ã„ã©ã†ã»ã†ã’ã‚“',
            'ãªã„ã‚Šãã»ã£ã‹ã„ã©ã†ã»ã†ã’ã‚“å·é’èŽ²å±…å£«',
            'AviÃ³n de pasajeros C919 de China inicia proceso de vuelo de validaciÃ³n',
            'Chine : un nouveau chemin de fer Ã  grande vitesse mis en service au Hunan',
            'Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨ÙŠØ© Ø³ØªØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø´Ø¹Ø¨ Ø³ÙŠÙ‚ÙˆÙ„ ÙƒÙ„Ù…ØªÙ‡',
            'Ð¡Ð¸ Ð¦Ð·Ð¸Ð½ÑŒÐ¿Ð¸Ð½ Ð¿Ð¾Ð´Ñ‡ÐµÑ€ÐºÐ½ÑƒÐ» Ð²Ð°Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¸ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ Ð»ÑŽÐ´ÐµÐ¹',
            'é•·æ±Ÿæ²³å£ã«ã€Œå¤§æ¨¹ã€ãŒå‡ºç¾ã€€æ±Ÿè˜‡çœå¼µå®¶æ¸¯å¸‚',
            'ì‹œì§„í•‘ ì£¼ì„, ì• êµ­ìœ„ìƒìš´ë™ 70ì£¼ë…„ ë§žì•„ "ì¸ë¯¼ì˜ ìƒëª… ì•ˆì „ê³¼ ê±´ê°• ë³´í˜¸" ì§€ì‹œ',
            '242342ç¬¬äºŒæœŸé‡‘ç£š243775åœ‹å®¶åª’é«”åŸ¹è¨“ç­é–‹ç­',
            'ðŸ‘fasfdrwerxcvcåœ‹å®¶åª’é«”åŸ¹è¨“ç­é–‹ç­',
            'fjaldfjwervcjl..sjflasfjxxxfjalrjwlj802Ùˆ'
        ];

        tests.forEach(text => {
            if (hasEmoji(text) || hasArabic(text)) {
                return;
            }
            console.log(text);
            const tm = ctx.measureText(text);
            const len = stringWidth(text, { ambiguousIsNarrow: false });
            console.log(tm.width, len * fontSize / 2);
        });

        function perf() {
            const time = 'measureText';
            console.time(time);
            for (let i = 0, len = 10000; i < len; i++) {
                tests.forEach(text => {
                    const tm = ctx.measureText(text);
                });
            }
            console.timeEnd(time);

            const time1 = 'stringWidth';
            console.time(time1);
            for (let i = 0, len = 10000; i < len; i++) {
                tests.forEach(text => {
                    const len = stringWidth(text, { ambiguousIsNarrow: false });
                });
            }
            console.timeEnd(time1);
        }
        perf();


    </script>
</body>

</html>